<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Test Merchant Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
    .test-button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    .test-button:hover { background: #0056b3; }
    .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px; }
    .error { background: #f8d7da; color: #721c24; }
    .success { background: #d4edda; color: #155724; }
    .info { background: #d1ecf1; color: #0c5460; }
    .address-input { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>🧪 Merchant Dashboard Test</h1>
    
    <div class="test-section">
      <h3>📊 Available Merchants</h3>
      <p>Based on the API data, here are some merchant addresses you can test with:</p>
      <div class="result info">
        <strong>0xb7aa464b19037cf3db7f723504dfafe7b63aab84</strong> - Has multiple transactions<br/>
        <strong>0x851df5acc897984a65259865522ad2d0325d77c5</strong> - Has transactions<br/>
        <strong>0x77ed7f6455fe291728a48785090292e3d10f53bb</strong> - Has transactions
      </div>
    </div>
    
    <div class="test-section">
      <h3>🔗 Quick Test Links</h3>
      <button class="test-button" onclick="testMerchant('0xb7aa464b19037cf3db7f723504dfafe7b63aab84')">
        Test Merchant 1 (0xb7aa...ab84)
      </button>
      <button class="test-button" onclick="testMerchant('0x851df5acc897984a65259865522ad2d0325d77c5')">
        Test Merchant 2 (0x851d...77c5)
      </button>
      <button class="test-button" onclick="testMerchant('0x77ed7f6455fe291728a48785090292e3d10f53bb')">
        Test Merchant 3 (0x77ed...53bb)
      </button>
    </div>
    
    <div class="test-section">
      <h3>✏️ Custom Address Test</h3>
      <input type="text" id="custom-address" class="address-input" placeholder="Enter merchant address (0x...)" />
      <button class="test-button" onclick="testCustomMerchant()">Test Custom Address</button>
    </div>
    
    <div class="test-section">
      <h3>🔍 API Test</h3>
      <button class="test-button" onclick="testAPI()">Test Merchant API</button>
      <div id="api-result" class="result" style="display: none;"></div>
    </div>
    
    <div class="test-section">
      <h3>📱 Direct Access</h3>
      <p>You can also access the merchant dashboard directly:</p>
      <ul>
        <li><a href="http://localhost:8081/login.html" target="_blank">Login Page</a></li>
        <li><a href="http://localhost:8081/merchant-dashboard.html?address=0xb7aa464b19037cf3db7f723504dfafe7b63aab84" target="_blank">Direct Dashboard (Merchant 1)</a></li>
      </ul>
    </div>
  </div>

  <script>
    function testMerchant(address) {
      const url = `http://localhost:8081/merchant-dashboard.html?address=${encodeURIComponent(address)}`;
      window.open(url, '_blank');
    }
    
    function testCustomMerchant() {
      const address = document.getElementById('custom-address').value.trim();
      if (!address) {
        alert('Please enter a merchant address');
        return;
      }
      
      if (!address.startsWith('0x') || address.length !== 42) {
        alert('Please enter a valid Ethereum address (0x...)');
        return;
      }
      
      testMerchant(address);
    }
    
    async function testAPI() {
      const resultDiv = document.getElementById('api-result');
      resultDiv.style.display = 'block';
      resultDiv.className = 'result';
      resultDiv.textContent = 'Testing merchant API...';
      
      try {
        const testAddress = '0xb7aa464b19037cf3db7f723504dfafe7b63aab84';
        const response = await fetch(`http://localhost:8081/api/merchant/${testAddress}/payouts`);
        const data = await response.json();
        
        if (response.ok) {
          const count = Array.isArray(data) ? data.length : (data.list ? data.list.length : 0);
          resultDiv.className = 'result success';
          resultDiv.innerHTML = `✅ Merchant API working!<br/>Merchant: ${testAddress}<br/>Filtered transactions: ${count}<br/>Sample transaction: ${data[0] ? data[0].TxHash : 'None'}`;
        } else {
          throw new Error(`HTTP ${response.status}: ${data.error || 'Unknown error'}`);
        }
      } catch (error) {
        resultDiv.className = 'result error';
        resultDiv.textContent = `❌ API test failed: ${error.message}`;
      }
    }
    
    // Auto-fill with a test address
    document.getElementById('custom-address').value = '0xb7aa464b19037cf3db7f723504dfafe7b63aab84';
  </script>
</body>
</html>
